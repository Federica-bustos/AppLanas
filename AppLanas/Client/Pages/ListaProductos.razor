@page "/productos"

@inject IHttpServicio http

<h3>ListaProductos</h3>

<PageTitle> PRODUCTOS </PageTitle>

<HeadContent>	
	<meta name="description" content="Listado de profesiones"
</HeadContent>

<h3>lista de productos</h3>

<table>
	<tr>
		<th>Nombre Producto </th>
		<th>Precio Proveedor </th>
		<th>Porcentaje Ganancia </th>
		<th>Precio Producto (con su % final)  </th>
	</tr>

	@if(Error)
	{
		<tr>@Mensaje</tr>
	}

	else 
	{
		@if (productos == null)
		{
			<tr>Cargando...</tr>
		}

		else if (productos.Count == 0)
		{
			<tr>no existen datos</tr>
		}

		else
		{
			@foreach(var item in productos)
			{
				<tr>
					<td>@item.nombreProducto</td>
					<td>@item.precioProveedor</td>
					<td>@item.porcentajeGanancia</td>
					<td>@item.precioProducto</td>
				</tr>	
			}
		}
	}
</table>

@code {
	List<Producto>? productos;
	bool Error = false;
	string Mensaje = "";

	protected override async Task OnInitializedAsync()
	{
		await base.OnInitializedAsync();
		await Leer();

	}

	private async Task Leer()
	{
		var respuesta = await http.Get<List<Producto>>("api/Producto");
		if(!respuesta.Error)
		{
			productos = respuesta.Respuesta;
		}
		else
		{
			Mensaje = await respuesta.ObtenerError();
		}
	}
}

